(function(){'use strict';angular.module("BBAdminServices",["BB","BBAdmin.Services","BBAdmin.Filters","BBAdmin.Controllers","trNgGrid","ui.calendar"]),angular.module("BBAdminServicesMockE2E",["BBAdminServices","BBAdminMockE2E"])}).call(this),function(){'use strict';angular.module("BBAdminServices").config(["$logProvider",function(e){'ngInject';e.debugEnabled(!0)}])}.call(this),function(){'use strict';var e=function(e,r){function s(){this.constructor=e}for(var o in r)t.call(r,o)&&(e[o]=r[o]);return s.prototype=r.prototype,e.prototype=new s,e.__super__=r.prototype,e},t={}.hasOwnProperty;window.Collection.Clinic=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return e(r,t),r.prototype.checkItem=function(){return r.__super__.checkItem.apply(this,arguments)},r.prototype.matchesParams=function(e){return!(this.params.start_time&&(this.start_time||(this.start_time=moment(this.params.start_time)),this.start_time.isAfter(e.start_time)))&&!(this.params.end_time&&(this.end_time||(this.end_time=moment(this.params.end_time)),this.end_time.isBefore(e.end_time)))&&!(this.params.start_date&&(this.start_date||(this.start_date=moment(this.params.start_date)),this.start_date.isAfter(e.start_date)))&&!(this.params.end_date&&(this.end_date||(this.end_date=moment(this.params.end_date)),this.end_date.isBefore(e.end_date)))},r}(window.Collection.Base),angular.module("BBAdmin.Services").provider("ClinicCollections",function(){return{$get:function(){return new window.BaseCollections}}})}.call(this),function(){'use strict';angular.module("BBAdminServices").directive("personTable",["$log","ModalForm","BBModel",function(e,t,r){var s,o;return s=function(s){return s.fields=["id","name","mobile"],s.getPeople=function(){return r.Admin.Person.$query({company:s.company}).then(function(e){return s.people=e})},s.newPerson=function(){return t["new"]({company:s.company,title:"New Person",new_rel:"new_person",post_rel:"people",success:function(e){return s.people.push(e)}})},s["delete"]=function(t){return t.$del("self").then(function(){return s.people=_.reject(s.people,t)},function(){return e.error("Failed to delete person")})},s.edit=function(e){return t.edit({model:e,title:"Edit Person"})},s.schedule=function(e){return e.$get("schedule").then(function(e){return t.edit({model:e,title:"Edit Schedule"})})}},o=function(e,t,s){return e.company?e.getPeople():r.Admin.Company.$query(s).then(function(t){return e.company=t,e.getPeople()})},{controller:s,link:o,templateUrl:"person_table_main.html"}}])}.call(this),function(){'use strict';angular.module("BBAdminServices").directive("resourceTable",["BBModel","$log","ModalForm",function(e,t,r){var s,o;return s=function(s){return s.fields=["id","name"],s.getResources=function(){var t;return t={company:s.company},e.Admin.Resource.$query(t).then(function(e){return s.resources=e})},s.newResource=function(){return r["new"]({company:s.company,title:"New Resource",new_rel:"new_resource",post_rel:"resources",size:"lg",success:function(e){return s.resources.push(e)}})},s["delete"]=function(e){return e.$del("self").then(function(){return s.resources=_.reject(s.resources,function(e){return e.id===id})},function(){return t.error("Failed to delete resource")})},s.edit=function(e){return r.edit({model:e,title:"Edit Resource"})},s.schedule=function(e){return e.$get("schedule").then(function(e){return r.edit({model:e,title:"Edit Schedule"})})}},o=function(t,r,s){return t.company?t.getResources():e.Admin.Company.$query(s).then(function(e){return t.company=e,t.getResources()})},{controller:s,link:o,templateUrl:"resource_table_main.html"}}])}.call(this),function(){'use strict';angular.module("BBAdminServices").directive("scheduleCalendar",["uiCalendarConfig","ScheduleRules",function(e,t){var r,s;return r=function(t){var r;return t.calendarName="scheduleCal",t.eventSources=[{events:function(e,r,s,o){return o(t.getEvents())}}],t.getCalendarEvents=function(t,r){var s;return s=e.calendars.scheduleCal.fullCalendar("clientEvents",function(s){return(t.isAfter(s.start)||t.isSame(s.start))&&(r.isBefore(s.end)||r.isSame(s.end))})},r=t.setOptions,r||(r={}),t.options={calendar:{schedulerLicenseKey:"0598149132-fcs-1443104297",height:r.height||"auto",editable:!1,selectable:!0,defaultView:"agendaWeek",header:{left:"today,prev,next",center:"title",right:"month,agendaWeek"},selectHelper:!1,eventOverlap:!1,lazyFetching:!1,views:{agendaWeek:{duration:{weeks:1},allDaySlot:!1,slotEventOverlap:!1,minTime:r.min_time||"00:00:00",maxTime:r.max_time||"24:00:00"}},select:function(e,r){var s;return s=t.getCalendarEvents(e,r),0<s.length?t.removeRange(e,r):t.addRange(e,r)},eventResizeStop:function(e){return t.addRange(e.start,e.end)},eventDrop:function(e,r){var s;if(e.start.hasTime())return s={start:moment(e.start).subtract(r),end:moment(e.end).subtract(r)},t.removeRange(s.start,s.end),t.addRange(e.start,e.end)},eventClick:function(e){return t.removeRange(e.start,e.end)}}},t.render=function(){return e.calendars.scheduleCal.fullCalendar("render")}},s=function(r,s,o,l){var a;return a=function(){return new t(l.$viewValue)},r.getEvents=function(){return a().toEvents()},r.addRange=function(e,t){return l.$setViewValue(a().addRange(e,t)),l.$render()},r.removeRange=function(e,t){return l.$setViewValue(a().removeRange(e,t)),l.$render()},r.toggleRange=function(e,t){return l.$setViewValue(a().toggleRange(e,t)),l.$render()},l.$render=function(){if(e&&e.calendars.scheduleCal)return e.calendars.scheduleCal.fullCalendar("refetchEvents"),e.calendars.scheduleCal.fullCalendar("unselect")}},{controller:r,link:s,templateUrl:"schedule_cal_main.html",require:"ngModel",scope:{render:"=?",setOptions:"=options"}}}])}.call(this),function(){'use strict';angular.module("BBAdminServices").directive("scheduleEdit",function(){var e;return e=function(e,t,r,s){return s.$render=function(){return e.$$value$$=s.$viewValue},e.$watch("$$value$$",function(e){if(null!=e)return s.$setViewValue(e)})},{link:e,templateUrl:"schedule_edit_main.html",require:"ngModel",scope:{options:"="}}}),angular.module("schemaForm").config(["schemaFormProvider","schemaFormDecoratorsProvider","sfPathProvider",function(e,t){return t.addMapping("bootstrapDecorator","schedule","schedule_edit_form.html"),t.createDirective("schedule","schedule_edit_form.html")}])}.call(this),function(){'use strict';angular.module("BBAdminServices").directive("scheduleTable",["BBModel","$log","ModalForm",function(e,t,r){var s,o;return s=function(s){return s.fields=["id","name","mobile"],s.getSchedules=function(){var t;return t={company:s.company},e.Admin.Schedule.query(t).then(function(e){return s.schedules=e})},s.newSchedule=function(){return r["new"]({company:s.company,title:"New Schedule",new_rel:"new_schedule",post_rel:"schedules",size:"lg",success:function(e){return s.schedules.push(e)}})},s["delete"]=function(e){return e.$del("self").then(function(){return s.schedules=_.reject(s.schedules,e)},function(){return t.error("Failed to delete schedule")})},s.edit=function(e){return r.edit({model:e,title:"Edit Schedule",size:"lg"})}},o=function(t,r,s){return t.company?t.getSchedules():e.Admin.Company.query(s).then(function(e){return t.company=e,t.getSchedules()})},{controller:s,link:o,templateUrl:"schedule_table_main.html"}}])}.call(this),function(){'use strict';angular.module("BBAdminServices").directive("scheduleWeekdays",["uiCalendarConfig","ScheduleRules",function(e,t){var r,s;return r=function(t){var r;return t.calendarName="scheduleWeekdays",t.eventSources=[{events:function(e,r,s,o){return o(t.getEvents())}}],t.getCalendarEvents=function(t,r){var s;return s=e.calendars.scheduleWeekdays.fullCalendar("clientEvents",function(s){return(t.isAfter(s.start)||t.isSame(s.start))&&(r.isBefore(s.end)||r.isSame(s.end))})},r=t.setOptions,r||(r={}),t.options={calendar:{schedulerLicenseKey:"0598149132-fcs-1443104297",height:r.height||"auto",editable:!1,selectable:!0,defaultView:"agendaWeek",header:{left:"",center:"title",right:""},selectHelper:!1,eventOverlap:!1,views:{agendaWeek:{duration:{weeks:1},titleFormat:"[]",allDaySlot:!1,columnFormat:"ddd",slotEventOverlap:!1,minTime:r.min_time||"00:00:00",maxTime:r.max_time||"24:00:00"}},select:function(e,r){var s;return s=t.getCalendarEvents(e,r),0<s.length?t.removeRange(e,r):t.addRange(e,r)},eventResizeStop:function(e){return t.addRange(e.start,e.end)},eventDrop:function(e,r){var s;if(e.start.hasTime())return s={start:moment(e.start).subtract(r),end:moment(e.end).subtract(r)},t.removeRange(s.start,s.end),t.addRange(e.start,e.end)},eventClick:function(e){return t.removeRange(e.start,e.end)}}},t.render=function(){return e.calendars.scheduleWeekdays.fullCalendar("render")}},s=function(r,s,o,l){var a;return a=function(){return new t(l.$viewValue)},r.getEvents=function(){return a().toWeekdayEvents()},r.addRange=function(e,t){return l.$setViewValue(a().addWeekdayRange(e,t)),l.$render()},r.removeRange=function(e,t){return l.$setViewValue(a().removeWeekdayRange(e,t)),l.$render()},l.$render=function(){if(e&&e.calendars.scheduleWeekdays)return e.calendars.scheduleWeekdays.fullCalendar("refetchEvents"),e.calendars.scheduleWeekdays.fullCalendar("unselect")}},{controller:r,link:s,templateUrl:"schedule_cal_main.html",require:"ngModel",scope:{render:"=?",setOptions:"=options"}}}])}.call(this),function(){'use strict';angular.module("BBAdminServices").directive("serviceTable",["$uibModal","$log","ModalForm","BBModel",function(e,t,r,s){var o,l;return o=function(e){return e.fields=["id","name"],e.getServices=function(){var t;return t={company:e.company},s.Admin.Service.$query(t).then(function(t){return e.services=t})},e.newService=function(){return r["new"]({company:e.company,title:"New Service",new_rel:"new_service",post_rel:"services",success:function(t){return e.services.push(t)}})},e["delete"]=function(r){return r.$del("self").then(function(){return e.services=_.reject(e.services,r)},function(){return t.error("Failed to delete service")})},e.edit=function(e){return r.edit({model:e,title:"Edit Service"})},e.newBooking=function(s){return r.book({model:s,company:e.company,title:"New Booking",success:function(e){return t.info("Created new booking ",e)}})}},l=function(e,t,r){return e.company?e.getServices():s.Admin.Company.query(r).then(function(t){return e.company=t,e.getServices()})},{controller:o,link:l,templateUrl:"service_table_main.html"}}])}.call(this),function(){'use strict';var e=function(e,r){function s(){this.constructor=e}for(var o in r)t.call(r,o)&&(e[o]=r[o]);return s.prototype=r.prototype,e.prototype=new s,e.__super__=r.prototype,e},t={}.hasOwnProperty;angular.module("BB.Models").factory("AdminAddressModel",["$q","BBModel","BaseModel","AddressModel",function(t,r,s,o){var l;return l=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return e(r,t),r.prototype.distanceFrom=function(e){var r,t=Math.round;return this.dists||(this.dists=[]),(r=this.dists)[e]||(r[e]=t(50*Math.random(),0)),this.dists[e]},r}(o)}])}.call(this),function(){'use strict';var e=function(e,r){function s(){this.constructor=e}for(var o in r)t.call(r,o)&&(e[o]=r[o]);return s.prototype=r.prototype,e.prototype=new s,e.__super__=r.prototype,e},t={}.hasOwnProperty;angular.module("BB.Models").factory("AdminClinicModel",["$q","BBModel","BaseModel","ClinicModel",function(t,r,s,o){var l;return l=function(t){function r(e){var t;r.__super__.constructor.call(this,e),this.repeat_rule||(this.repeat_rule={}),(t=this.repeat_rule).rules||(t.rules={})}return e(r,t),r.prototype.calcRepeatRule=function(){var e,t,r,s,o,l;for(t in l={},l.name=this.name,l.start_time=this.start_time.format("HH:mm"),l.end_time=this.end_time.format("HH:mm"),l.address_id=this.address_id,l.resource_ids=[],r=this.resources,r)e=r[t],e&&l.resource_ids.push(t);for(t in l.person_ids=[],s=this.people,s)e=s[t],e&&l.person_ids.push(t);for(t in l.service_ids=[],o=this.services,o)e=o[t],e&&l.service_ids.push(t);return this.repeat_rule.properties=l,this.repeat_rule},r.prototype.getPostData=function(){var e,t,r,s,o,l;for(r in e={},e.name=this.name,e.repeat_rule=this.repeat_rule,e.start_time=this.start_time,e.end_time=this.end_time,e.resource_ids=[],e.update_for_repeat=this.update_for_repeat,s=this.resources,s)t=s[r],t&&e.resource_ids.push(r);for(r in e.person_ids=[],o=this.people,o)t=o[r],t&&e.person_ids.push(r);for(r in e.service_ids=[],l=this.services,l)t=l[r],t&&e.service_ids.push(r);return this.address&&(e.address_id=this.address.id),this.settings&&(e.settings=this.settings),this.repeat_rule&&this.repeat_rule.rules&&this.repeat_rule.rules.frequency&&(e.repeat_rule=this.calcRepeatRule()),e},r.prototype.save=function(){return this.person_ids=_.compact(_.map(this.people,function(e,t){if(e)return t})),this.resource_ids=_.compact(_.map(this.resources,function(e,t){if(e)return t})),this.service_ids=_.compact(_.map(this.services,function(e,t){if(e)return t})),this.$put("self",{},this).then(function(e){return function(t){return e.updateModel(t),e.setTimes(),e.setResourcesAndPeople()}}(this))},r.prototype.$update=function(e){return e||(e=this),this.$put("self",{},e).then(function(e){return function(t){return e.constructor(t)}}(this))},r}(o)}])}.call(this),function(){'use strict';var e=function(e,r){function s(){this.constructor=e}for(var o in r)t.call(r,o)&&(e[o]=r[o]);return s.prototype=r.prototype,e.prototype=new s,e.__super__=r.prototype,e},t={}.hasOwnProperty;angular.module("BB.Models").factory("AdminPersonModel",["$q","AdminPersonService","BBModel","BaseModel","PersonModel",function(t,r,s,o,l){var a;return a=function(o){function l(e){l.__super__.constructor.call(this,e)}return e(l,o),l.prototype.setAttendance=function(e,r){var s;return s=t.defer(),this.$put("attendance",{},{status:e,estimated_duration:r}).then(function(e){return function(t){return e.updateModel(t),s.resolve(e)}}(this),function(){return function(e){return s.reject(e)}}(this)),s.promise},l.prototype.finishServing=function(){var e;return e=t.defer(),this.$has("finish_serving")?(this.$flush("self"),this.$post("finish_serving").then(function(t){return function(r){return t.$get("self").then(function(e){return t.updateModel(e)}),t.serving=null,e.resolve(r)}}(this),function(){return function(t){return e.reject(t)}}(this))):e.reject("finish_serving link not available"),e.promise},l.prototype.isAvailable=function(e,t){var r;return(r=e.format("YYYY-MM-DD")+"-"+t.format("YYYY-MM-DD"),this.availability||(this.availability={}),this.availability[r])?"Yes"===this.availability[r]:(this.availability[r]="-",this.$has("schedule")?this.$get("schedule",{start_date:e.format("YYYY-MM-DD"),end_date:t.format("YYYY-MM-DD")}).then(function(t){return function(s){if(t.availability[r]="No",s&&s.dates&&s.dates[e.format("YYYY-MM-DD")]&&"None"!==s.dates[e.format("YYYY-MM-DD")])return t.availability[r]="Yes"}}(this)):this.availability[r]="Yes","Yes"===this.availability[r])},l.prototype.startServing=function(e){var r,s;return r=t.defer(),this.$has("start_serving")?(this.$flush("self"),s={queuer_id:e?e.id:null},this.$post("start_serving",s).then(function(e){return function(t){return e.$get("self").then(function(t){return e.updateModel(t)}),e.serving=t,r.resolve(t)}}(this),function(){return function(e){return r.reject(e)}}(this))):r.reject("start_serving link not available"),r.promise},l.prototype.getQueuers=function(){var e;return e=t.defer(),this.$has("queuers")?(this.$flush("queuers"),this.$get("queuers").then(function(t){return function(r){return r.$get("queuers").then(function(r){var o,l;return o=function(){var e,t,o;for(o=[],e=0,t=r.length;e<t;e++)l=r[e],o.push(new s.Admin.Queuer(l));return o}(),t.queuers=o,e.resolve(o)},function(t){return e.reject(t)})}}(this),function(){return function(t){return e.reject(t)}}(this))):e.reject("queuers link not available"),e.promise},l.prototype.getPostData=function(){var e;return e={},e.id=this.id,e.name=this.name,e.extra=this.extra,e.description=this.description,e},l.prototype.$update=function(e){return e||(e=this.getPostData()),this.$put("self",{},e).then(function(e){return function(t){return e.constructor(t)}}(this))},l.$query=function(e){return r.query(e)},l.$block=function(e,t,s){return r.block(e,t,s)},l.$signup=function(e,t){return r.signup(e,t)},l.prototype.$refetch=function(){var e;return e=t.defer(),this.$flush("self"),this.$get("self").then(function(t){return function(r){return t.constructor(r),e.resolve(t)}}(this),function(t){return e.reject(t)}),e.promise},l}(l)}])}.call(this),function(){'use strict';var e=function(e,r){function s(){this.constructor=e}for(var o in r)t.call(r,o)&&(e[o]=r[o]);return s.prototype=r.prototype,e.prototype=new s,e.__super__=r.prototype,e},t={}.hasOwnProperty;angular.module("BB.Models").factory("AdminResourceModel",["$q","AdminResourceService","BBModel","BaseModel","ResourceModel",function(t,r,s,o,l){var a;return a=function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return e(s,t),s.prototype.isAvailable=function(e,t){var r;return(r=e.format("YYYY-MM-DD")+"-"+t.format("YYYY-MM-DD"),this.availability||(this.availability={}),this.availability[r])?"Yes"===this.availability[r]:(this.availability[r]="-",this.$has("schedule")?this.$get("schedule",{start_date:e.format("YYYY-MM-DD"),end_date:t.format("YYYY-MM-DD")}).then(function(t){return function(s){if(t.availability[r]="No",s&&s.dates&&s.dates[e.format("YYYY-MM-DD")]&&"None"!==s.dates[e.format("YYYY-MM-DD")])return t.availability[r]="Yes"}}(this)):this.availability[r]="Yes","Yes"===this.availability[r])},s.$query=function(e){return r.query(e)},s.$block=function(e,t,s){return r.block(e,t,s)},s}(l)}])}.call(this),function(){'use strict';var e=function(e,r){function s(){this.constructor=e}for(var o in r)t.call(r,o)&&(e[o]=r[o]);return s.prototype=r.prototype,e.prototype=new s,e.__super__=r.prototype,e},t={}.hasOwnProperty;angular.module("BB.Models").factory("AdminScheduleModel",["$q","AdminScheduleService","BBModel","BaseModel","ScheduleRules",function(t,r,s,o){var l;return l=function(t){function s(e){s.__super__.constructor.call(this,e)}return e(s,t),s.prototype.getPostData=function(){var e;return e={},e.id=this.id,e.rules=this.rules,e.name=this.name,e.company_id=this.company_id,e.duration=this.duration,e},s.$query=function(e){return r.query(e)},s.$delete=function(e){return r["delete"](e)},s.$update=function(e){return r.update(e)},s}(o)}])}.call(this),function(){'use strict';var e=function(e,t){return function(){return e.apply(t,arguments)}};angular.module("BB.Models").factory("ScheduleRules",function(){var t;return t=function(){function t(t){null==t&&(t={}),this.removeRangeFromDate=e(this.removeRangeFromDate,this),this.addRangeToDate=e(this.addRangeToDate,this),this.rules=t}return t.prototype.addRange=function(e,t){return this.applyFunctionToDateRange(e,t,"YYYY-MM-DD",this.addRangeToDate)},t.prototype.removeRange=function(e,t){return this.applyFunctionToDateRange(e,t,"YYYY-MM-DD",this.removeRangeFromDate)},t.prototype.addWeekdayRange=function(e,t){return this.applyFunctionToDateRange(e,t,"d",this.addRangeToDate)},t.prototype.removeWeekdayRange=function(e,t){return this.applyFunctionToDateRange(e,t,"d",this.removeRangeFromDate)},t.prototype.addRangeToDate=function(e,t){var r;return r=this.rules[e]?this.rules[e]:[],this.rules[e]=this.joinRanges(this.insertRange(r,t))},t.prototype.removeRangeFromDate=function(e,t){var r;if(r=this.rules[e]?this.rules[e]:[],this.rules[e]=this.joinRanges(this.subtractRange(r,t)),""===this.rules[e])return delete this.rules[e]},t.prototype.applyFunctionToDateRange=function(e,t,r,s){var o,l,a,n,i;return l=this.diffInDays(e,t),0===l?(o=e.format(r),n=[e.format("HHmm"),t.format("HHmm")].join("-"),s(o,n)):(a=moment(e).endOf("day"),this.applyFunctionToDateRange(e,a,r,s),_.each(function(){i=[];for(var e=1;1<=l?e<=l:e>=l;1<=l?e++:e--)i.push(e);return i}.apply(this),function(n){return function(d){var i;return(o=moment(e).add(d,"days"),d!==l)?(i=moment(o).startOf("day"),a=moment(o).endOf("day"),n.applyFunctionToDateRange(i,a,r,s)):0!==t.hour()||0!==t.minute()?(i=moment(t).startOf("day"),n.applyFunctionToDateRange(i,t,r,s)):void 0}}(this))),this.rules},t.prototype.diffInDays=function(e,t){return moment.duration(t.diff(e)).days()},t.prototype.insertRange=function(e,t){return e.splice(_.sortedIndex(e,t),0,t),e},t.prototype.subtractRange=function(e,t){return-1<_.indexOf(e,t,!0)?_.without(e,t):_.flatten(_.map(e,function(e){return t.slice(0,4)>=e.slice(0,4)&&t.slice(5,9)<=e.slice(5,9)?t.slice(0,4)===e.slice(0,4)?[t.slice(5,9),e.slice(5,9)].join("-"):t.slice(5,9)===e.slice(5,9)?[e.slice(0,4),t.slice(0,4)].join("-"):[[e.slice(0,4),t.slice(0,4)].join("-"),[t.slice(5,9),e.slice(5,9)].join("-")]:e}))},t.prototype.joinRanges=function(e){return _.reduce(e,function(e,t){return""===e?t:t.slice(0,4)<=e.slice(e.length-4,e.length)?t.slice(5,9)>=e.slice(e.length-4,e.length)?e.slice(0,e.length-4)+t.slice(5,9):e:[e,t].join()},"").split(",")},t.prototype.filterRulesByDates=function(){return _.pick(this.rules,function(e,t){return t.match(/^\d{4}-\d{2}-\d{2}$/)&&"None"!==e})},t.prototype.filterRulesByWeekdays=function(){return _.pick(this.rules,function(e,t){return t.match(/^\d$/)})},t.prototype.formatTime=function(e){return[e.slice(0,2),e.slice(2,4)].join(":")},t.prototype.toEvents=function(e){return e&&"None"!==this.rules[e]?_.map(this.rules[e],function(t){return function(r){return{start:[e,t.formatTime(r.split("-")[0])].join("T"),end:[e,t.formatTime(r.split("-")[1])].join("T")}}}(this)):_.reduce(this.filterRulesByDates(),function(e){return function(t,r,s){return t.concat(_.map(r,function(t){return{start:[s,e.formatTime(t.split("-")[0])].join("T"),end:[s,e.formatTime(t.split("-")[1])].join("T")}}))}}(this),[])},t.prototype.toWeekdayEvents=function(){return _.reduce(this.filterRulesByWeekdays(),function(e){return function(t,r,s){var o;return o=moment().set("day",s).format("YYYY-MM-DD"),t.concat(_.map(r,function(t){return{start:[o,e.formatTime(t.split("-")[0])].join("T"),end:[o,e.formatTime(t.split("-")[1])].join("T")}}))}}(this),[])},t}()})}.call(this),function(){'use strict';var e=function(e,r){function s(){this.constructor=e}for(var o in r)t.call(r,o)&&(e[o]=r[o]);return s.prototype=r.prototype,e.prototype=new s,e.__super__=r.prototype,e},t={}.hasOwnProperty;angular.module("BB.Models").factory("AdminServiceModel",["$q","AdminServiceService","BBModel","ServiceModel",function(t,r,s,o){var l;return l=function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return e(s,t),s.$query=function(e){return r.query(e)},s}(o)}])}.call(this),function(){'use strict';angular.module("BBAdmin.Services").factory("AdminAddressService",["$q","BBModel",function(e,t){return{query:function(r){var s,o;return s=r.company,o=e.defer(),s.$get("addresses").then(function(e){return e.$get("addresses").then(function(e){var r,l;return r=function(){var r,s,o;for(o=[],r=0,s=e.length;r<s;r++)l=e[r],o.push(new t.Admin.Address(l));return o}(),o.resolve(r)},function(e){return o.reject(e)})},function(e){return o.reject(e)}),o.promise}}}])}.call(this),function(){'use strict';angular.module("BBAdmin.Services").factory("AdminClinicService",["$q","BBModel","ClinicCollections","$window",function(e,t,r,o){return{query:function(l){var a,n,i;return a=l.company,n=e.defer(),l.id?a.$get("clinics",l).then(function(e){return e=new t.Admin.Clinic(e),n.resolve(e)},function(e){return n.reject(e)}):(i=r.find(l),i&&!l.skip_cache?n.resolve(i):(l.skip_cache&&(i&&r["delete"](i),a.$flush("clinics",l)),a.$get("clinics",l).then(function(e){return e.$get("clinics").then(function(a){var i,d;return i=function(){var e,r,s;for(s=[],e=0,r=a.length;e<r;e++)d=a[e],s.push(new t.Admin.Clinic(d));return s}(),a=new o.Collection.Clinic(e,i,l),r.add(a),n.resolve(a)},function(e){return n.reject(e)})},function(e){return n.reject(e)}))),n.promise},create:function(s,o){var l,a;return l=s.company,a=e.defer(),l.$post("clinics",{},o.getPostData()).then(function(){return function(e){return e=new t.Admin.Clinic(e),r.checkItems(e),a.resolve(e)}}(this),function(){return function(e){return a.reject(e)}}(this)),a.promise},cancel:function(s){var o;return o=e.defer(),s.$post("cancel",s).then(function(){return function(e){return e=new t.Admin.Clinic(e),r.deleteItems(e),o.resolve(e)}}(this),function(){return function(e){return o.reject(e)}}(this)),o.promise},update:function(s){var o;return o=e.defer(),s.$put("self",{},s.getPostData()).then(function(){return function(e){return s=new t.Admin.Clinic(e),r.checkItems(s),o.resolve(s)}}(this),function(){return function(e){return o.reject(e)}}(this)),o.promise}}}])}.call(this),function(){'use strict';angular.module("BBAdminServices").factory("AdminPersonService",["$q","$window","$rootScope","halClient","SlotCollections","BookingCollections","BBModel","LoginService","$log",function(e,t,r,s,o,l,a,n,i){return{query:function(t){var r,s;return r=t.company,s=e.defer(),r.$has("people")?r.$get("people",t).then(function(e){var t;return e.$has("people")?e.$get("people").then(function(e){var t,r;return t=function(){var t,s,o;for(o=[],t=0,s=e.length;t<s;t++)r=e[t],o.push(new a.Admin.Person(r));return o}(),s.resolve(t)},function(e){return s.reject(e)}):(t=new a.Admin.Person(e),s.resolve(t))},function(e){return s.reject(e)}):(i.warn("company has no people link"),s.reject("company has no people link")),s.promise},block:function(t,r,s){var n;return n=e.defer(),r.$put("block",{},s).then(function(){return function(e){var t,r;return-1<e.$href("self").indexOf("bookings")?(t=new a.Admin.Booking(e),l.checkItems(t),n.resolve(t)):(r=new a.Admin.Slot(e),o.checkItems(r),n.resolve(r))}}(this),function(){return function(e){return n.reject(e)}}(this)),n.promise},signup:function(t,r){var s;return s=e.defer(),t.$get("company").then(function(e){var t;return t={},e.$post("people",t,r).then(function(e){return e.$has("administrator")?e.$get("administrator").then(function(t){return n.setLogin(t),s.resolve(e)}):s.resolve(e)},function(e){return s.reject(e)}),s.promise})}}}])}.call(this),function(){'use strict';angular.module("BBAdmin.Services").factory("AdminResourceService",["$q","UriTemplate","halClient","SlotCollections","BBModel","BookingCollections",function(e,t,r,s,o,l){return{query:function(t){var r,s;return r=t.company,s=e.defer(),r.$get("resources",t).then(function(e){return e.$get("resources").then(function(e){var t,l;return t=function(){var t,r,s;for(s=[],t=0,r=e.length;t<r;t++)l=e[t],s.push(new o.Admin.Resource(l));return s}(),s.resolve(t)},function(e){return s.reject(e)})},function(e){return s.reject(e)}),s.promise},block:function(t,r,a){var n;return n=e.defer(),r.$put("block",{},a).then(function(){return function(e){var t,r;return-1<e.$href("self").indexOf("bookings")?(t=new o.Admin.Booking(e),l.checkItems(t),n.resolve(t)):(r=new o.Admin.Slot(e),s.checkItems(r),n.resolve(r))}}(this),function(){return function(e){return n.reject(e)}}(this)),n.promise}}}])}.call(this),function(){'use strict';angular.module("BBAdmin.Services").factory("AdminScheduleService",["$q","BBModel","ScheduleRules","BBAssets",function(e,t,r,s){var o,l,a,n;return n={},{query:function(r){var s,o;return s=r.company,o=e.defer(),s.$get("schedules").then(function(e){return e.$get("schedules").then(function(e){var r,l;return r=function(){var r,s,o;for(o=[],r=0,s=e.length;r<s;r++)l=e[r],o.push(new t.Admin.Schedule(l));return o}(),o.resolve(r)},function(e){return o.reject(e)})},function(e){return o.reject(e)}),o.promise},delete:function(r){var s;return s=e.defer(),r.$del("self").then(function(){return function(e){return e=new t.Admin.Schedule(e),s.resolve(e)}}(this),function(){return function(e){return s.reject(e)}}(this)),s.promise},update:function(r){var s;return s=e.defer(),r.$put("self",{},r.getPostData()).then(function(){return function(e){return r=new t.Admin.Schedule(e),s.resolve(r)}}(this),function(){return function(e){return s.reject(e)}}(this))}},o=function(e,t){var r,s,o,l;for(r in n[s=e.self]||(n[s]={}),o=[],t)l=t[r],o.push(n[e.self][r]=l);return o},l=function(e,t,r){var s,o,l,a,i,d;if(!n[e.self])return!1;for(i=moment(t),a=moment(r),o=moment(t),l=[],s=n[e.self];o.unix()<r.unix();){if(d=o.format("YYYY-MM-DD"),!s[d])return!1;l[d]=s[d],o=o.add(1,"day")}return l},a=function(t){var r,s,l,a,n;for(n=[],l=0,a=t.length;l<a;l++)r=t[l],r.$has("immediate_schedule")&&function(){return function(e){var t;return t=e.$get("immediate_schedule"),n.push(t),t.then(function(t){return o(e,t.dates)})}}(this)(r);return s=e.defer(),0<n.length?e.all(n).then(function(){return s.resolve()}):s.resolve(),s.promise},{mapAssetsToScheduleEvents:function(t,s,o){var a;return a=_.filter(o,function(e){return e.$has("schedule")}),_.map(a,function(o){var a,n,i,d,c;return n=l(o,t,s),n?(c=new r(n),a=c.toEvents(),_.each(a,function(t){return t.resourceId=parseInt(o.id)+"_"+o.type[0],t.title=o.name,t.start=moment(t.start),t.end=moment(t.end),t.rendering="background"}),d=e.defer(),d.resolve(a),d.promise):(i={start_date:t.format("YYYY-MM-DD"),end_date:s.format("YYYY-MM-DD")},o.$get("schedule",i).then(function(e){return c=new r(e.dates),a=c.toEvents(),_.each(a,function(t){return t.resourceId=parseInt(o.id)+"_"+o.type[0],t.title=o.name,t.start=moment(t.start),t.end=moment(t.end),t.rendering="background"}),a}))})},getAssetsScheduleEvents:function(t,r,o,l,n){var i;return null==l&&(l=!1),null==n&&(n=[]),l?a(n).then(function(t){return function(){return e.all(t.mapAssetsToScheduleEvents(r,o,n)).then(function(e){return _.flatten(e)})}}(this)):(i=this.mapAssetsToScheduleEvents,s.getAssets(t).then(function(t){return a(t).then(function(){return e.all(i(r,o,t)).then(function(e){return _.flatten(e)})})}))}}}])}.call(this),function(){'use strict';angular.module("BBAdmin.Services").factory("AdminServiceService",["$q","BBModel","$log",function(e,t){return{query:function(r){var s,o;return s=r.company,o=e.defer(),s.$get("services").then(function(e){return e.$get("services").then(function(e){var r,l;return r=function(){var r,s,o;for(o=[],r=0,s=e.length;r<s;r++)l=e[r],o.push(new t.Admin.Service(l));return o}(),o.resolve(r)},function(e){return o.reject(e)})},function(e){return o.reject(e)}),o.promise}}}])}.call(this),function(){'use strict';angular.module("BBAdminServices").factory("BB.Service.schedule",["$q","BBModel",function(e,t){return{unwrap:function(e){return new t.Admin.Schedule(e)}}}]),angular.module("BBAdminServices").factory("BB.Service.person",["$q","BBModel",function(e,t){return{unwrap:function(e){return new t.Admin.Person(e)}}}]),angular.module("BBAdminServices").factory("BB.Service.people",["$q","BBModel",function(e,t){return{promise:!0,unwrap:function(r){var s;return s=e.defer(),r.$get("people").then(function(){return function(e){var r,o,l,a;for(a=[],o=0,l=e.length;o<l;o++)r=e[o],a.push(new t.Admin.Person(r));return s.resolve(a)}}(this),function(){return function(e){return s.reject(e)}}(this)),s.promise}}}]),angular.module("BBAdminServices").factory("BB.Service.resource",["$q","BBModel",function(e,t){return{unwrap:function(e){return new t.Admin.Resource(e)}}}]),angular.module("BBAdminServices").factory("BB.Service.resources",["$q","BBModel",function(e,t){return{promise:!0,unwrap:function(r){var s;return s=e.defer(),r.$get("resources").then(function(){return function(e){var r,o,l,a;for(a=[],o=0,l=e.length;o<l;o++)r=e[o],a.push(new t.Admin.Resource(r));return s.resolve(a)}}(this),function(){return function(e){return s.reject(e)}}(this)),s.promise}}}]),angular.module("BBAdminServices").factory("BB.Service.service",["$q","BBModel",function(e,t){return{unwrap:function(e){return new t.Admin.Service(e)}}}]),angular.module("BBAdminServices").factory("BB.Service.services",["$q","BBModel",function(e,t){return{promise:!0,unwrap:function(r){var s;return s=e.defer(),r.$get("services").then(function(){return function(e){var r,o,l,a;for(a=[],o=0,l=e.length;o<l;o++)r=e[o],a.push(new t.Admin.Service(r));return s.resolve(a)}}(this),function(){return function(e){return s.reject(e)}}(this)),s.promise}}}])}.call(this),function(){"use strict";angular.module("BBAdminServices").config(["$translateProvider",function(e){"ngInject";var t;t={SERVICES:{PERSON_TABLE:{NEW_PERSON:"New Person",DELETE:"@:COMMON.BTN.DELETE",EDIT:"@:COMMON.BTN.EDIT",SCHEDULE:"@:COMMON.TERMINOLOGY.SCHEDULE"},RESOURCE_TABLE:{NEW_RESOURCE:"New Resource",DELETE:"@:COMMON.BTN.DELETE",EDIT:"@:COMMON.BTN.EDIT",SCHEDULE:"@:COMMON.TERMINOLOGY.SCHEDULE"},SERVICE_TABLE:{NEW_SERVICE:"New Service",EDIT:"@:COMMON.BTN.EDIT",BOOK_BTN:"@:COMMON.BTN.BOOK"}}},e.translations("en",t)}])}.call(this);